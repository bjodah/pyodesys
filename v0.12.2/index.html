

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Welcome to pyodesys’s documentation! &mdash; pyodesys 0.12.2 documentation</title>
  

  
  
  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  

  

  
        <link rel="index" title="Index"
              href="genindex.html"/>
        <link rel="search" title="Search" href="search.html"/>
    <link rel="top" title="pyodesys 0.12.2 documentation" href="#"/>
        <link rel="next" title="pyodesys package" href="pyodesys.html"/> 

  
  <script src="_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="#" class="icon icon-home"> pyodesys
          

          
          </a>

          
            
            
              <div class="version">
                0.12.2
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Contents:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="pyodesys.html">pyodesys package</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="#">pyodesys</a>
        
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="#">Docs</a> &raquo;</li>
        
      <li>Welcome to pyodesys’s documentation!</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/index.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="welcome-to-pyodesys-s-documentation">
<h1>Welcome to pyodesys’s documentation!<a class="headerlink" href="#welcome-to-pyodesys-s-documentation" title="Permalink to this headline">¶</a></h1>
<div class="toctree-wrapper compound">
<p class="caption"><span class="caption-text">Contents:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="pyodesys.html">pyodesys package</a><ul>
<li class="toctree-l2"><a class="reference internal" href="pyodesys.html#subpackages">Subpackages</a><ul>
<li class="toctree-l3"><a class="reference internal" href="pyodesys.native.html">pyodesys.native package</a><ul>
<li class="toctree-l4"><a class="reference internal" href="pyodesys.native.html#pyodesys-native">pyodesys.native</a></li>
<li class="toctree-l4"><a class="reference internal" href="pyodesys.native.html#submodules">Submodules</a></li>
<li class="toctree-l4"><a class="reference internal" href="pyodesys.native.html#module-pyodesys.native.cvode">pyodesys.native.cvode module</a></li>
<li class="toctree-l4"><a class="reference internal" href="pyodesys.native.html#module-pyodesys.native.gsl">pyodesys.native.gsl module</a></li>
<li class="toctree-l4"><a class="reference internal" href="pyodesys.native.html#module-pyodesys.native.odeint">pyodesys.native.odeint module</a></li>
<li class="toctree-l4"><a class="reference internal" href="pyodesys.native.html#module-pyodesys.native.util">pyodesys.native.util module</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="pyodesys.html#submodules">Submodules</a></li>
<li class="toctree-l2"><a class="reference internal" href="pyodesys.html#module-pyodesys.analysis">pyodesys.analysis module</a></li>
<li class="toctree-l2"><a class="reference internal" href="pyodesys.html#module-pyodesys.convergence">pyodesys.convergence module</a></li>
<li class="toctree-l2"><a class="reference internal" href="pyodesys.html#module-pyodesys.core">pyodesys.core module</a><ul class="simple">
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="pyodesys.html#module-pyodesys.integrators">pyodesys.integrators module</a><ul class="simple">
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="pyodesys.html#module-pyodesys.plotting">pyodesys.plotting module</a></li>
<li class="toctree-l2"><a class="reference internal" href="pyodesys.html#module-pyodesys.results">pyodesys.results module</a><ul class="simple">
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="pyodesys.html#module-pyodesys.symbolic">pyodesys.symbolic module</a><ul class="simple">
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="pyodesys.html#module-pyodesys.util">pyodesys.util module</a><ul class="simple">
</ul>
</li>
</ul>
</li>
</ul>
</div>
</div>
<div class="section" id="indices-and-tables">
<h1>Indices and tables<a class="headerlink" href="#indices-and-tables" title="Permalink to this headline">¶</a></h1>
<ul class="simple">
<li><a class="reference internal" href="genindex.html"><span class="std std-ref">Index</span></a></li>
<li><a class="reference internal" href="py-modindex.html"><span class="std std-ref">Module Index</span></a></li>
<li><a class="reference internal" href="search.html"><span class="std std-ref">Search Page</span></a></li>
</ul>
</div>
<div class="section" id="overview">
<h1>Overview<a class="headerlink" href="#overview" title="Permalink to this headline">¶</a></h1>
<a class="reference external image-reference" href="http://hera.physchem.kth.se:9090/bjodah/pyodesys"><img alt="Build status on Drone" src="http://hera.physchem.kth.se:9090/api/badges/bjodah/pyodesys/status.svg" /></a>
<a class="reference external image-reference" href="https://circleci.com/gh/bjodah/pyodesys"><img alt="Build status on CircleCI" src="https://circleci.com/gh/bjodah/pyodesys.svg?style=svg" /></a>
<a class="reference external image-reference" href="https://pypi.python.org/pypi/pyodesys"><img alt="PyPI version" src="https://img.shields.io/pypi/v/pyodesys.svg" /></a>
<a class="reference external image-reference" href="https://www.python.org/"><img alt="Python version" src="https://img.shields.io/badge/python-2.7,3.5,3.6-blue.svg" /></a>
<a class="reference external image-reference" href="https://github.com/bjodah/pyodesys/blob/master/LICENSE"><img alt="License" src="https://img.shields.io/pypi/l/pyodesys.svg" /></a>
<a class="reference external image-reference" href="http://hera.physchem.kth.se/~pyodesys/benchmarks"><img alt="airspeedvelocity" src="http://img.shields.io/badge/benchmarked%20by-asv-green.svg?style=flat" /></a>
<a class="reference external image-reference" href="http://hera.physchem.kth.se/~pyodesys/branches/master/htmlcov"><img alt="coverage" src="http://hera.physchem.kth.se/~pyodesys/branches/master/htmlcov/coverage.svg" /></a>
<a class="reference external image-reference" href="https://doi.org/10.21105/joss.00490"><img alt="Journal of Open Source Software DOI" src="http://joss.theoj.org/papers/10.21105/joss.00490/status.svg" /></a>
<p><a class="reference external" href="https://github.com/bjodah/pyodesys">pyodesys</a> provides a straightforward way
of numerically integrating systems of ordinary differential equations (initial value problems).
It unifies the interface of several libraries for performing the numerical integration as well as
several libraries for symbolic representation. It also provides a convenience class for
representing and integrating ODE systems defined by symbolic expressions, e.g. <a class="reference external" href="http://www.sympy.org">SymPy</a>
expressions. This allows the user to write concise code and rely on <code class="docutils literal notranslate"><span class="pre">pyodesys</span></code> to handle the subtle differences
between libraries.</p>
<p>The numerical integration is performed using either:</p>
<ul class="simple">
<li><a class="reference external" href="http://docs.scipy.org/doc/scipy/reference/generated/scipy.integrate.ode.html">scipy.integrate.ode</a></li>
<li><a class="reference external" href="https://github.com/bjodah/pygslodeiv2">pygslodeiv2</a></li>
<li><a class="reference external" href="https://github.com/bjodah/pyodeint">pyodeint</a></li>
<li><a class="reference external" href="https://github.com/bjodah/pycvodes">pycvodes</a></li>
</ul>
<p>Note that implicit steppers require a user supplied callback for calculating the Jacobian.
<code class="docutils literal notranslate"><span class="pre">pyodesys.SymbolicSys</span></code> derives the Jacobian automatically.</p>
<p>The symbolic representation is usually in the form of <a class="reference external" href="https://www.sympy.org/">SymPy</a>
expressions, but the user may choose another symbolic back-end (see <a class="reference external" href="https://github.com/bjodah/sym">sym</a>).</p>
<p>When performance is of utmost importance, e.g. in model fitting where results are needed
for a large set of initial conditions and parameters, the user may transparently
rely on compiled native code (classes in <code class="docutils literal notranslate"><span class="pre">pyodesys.native.native_sys</span></code> can generate optimal C++ code).
The major benefit is that there is no need to manually rewrite the corresponding expressions in another
programming language.</p>
<div class="section" id="documentation">
<h2>Documentation<a class="headerlink" href="#documentation" title="Permalink to this headline">¶</a></h2>
<p>Auto-generated API documentation for latest stable release is found here:
<a class="reference external" href="https://bjodah.github.io/pyodesys/latest">https://bjodah.github.io/pyodesys/latest</a>
(and the development version for the current master branch is found here:
<a class="reference external" href="http://hera.physchem.kth.se/~pyodesys/branches/master/html">http://hera.physchem.kth.se/~pyodesys/branches/master/html</a>).</p>
</div>
<div class="section" id="installation">
<h2>Installation<a class="headerlink" href="#installation" title="Permalink to this headline">¶</a></h2>
<p>Simplest way to install pyodesys and its (optional) dependencies is to use the
<a class="reference external" href="http://conda.pydata.org/docs/">conda package manager</a>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ conda install -c bjodah pyodesys pytest
$ python -m pytest --pyargs pyodesys
</pre></div>
</div>
<div class="section" id="optional-dependencies">
<h3>Optional dependencies<a class="headerlink" href="#optional-dependencies" title="Permalink to this headline">¶</a></h3>
<p>If you used <code class="docutils literal notranslate"><span class="pre">conda</span></code> to install <a class="reference external" href="https://github.com/bjodah/pyodesys">pyodesys</a> you can skip this section.
But if you use <code class="docutils literal notranslate"><span class="pre">pip</span></code> you may want to know that the default installation
of <code class="docutils literal notranslate"><span class="pre">pyodesys</span></code> only requires SciPy:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ pip install pyodesys
$ pytest --pyargs pyodesys -rs
</pre></div>
</div>
<p>The above command should finish without errors but with some skipped tests.
The reason for why some tests are skipped should be because missing optional solvers.
To install the optional solvers you will first need to install third party libraries for
the solvers and then their python bindings. The 3rd party requirements are as follows:</p>
<ul class="simple">
<li><a class="reference external" href="https://github.com/bjodah/pygslodeiv2">pygslodeiv2</a> (requires <a class="reference external" href="https://www.gnu.org/software/gsl/">GSL</a> &gt;=1.16)</li>
<li><a class="reference external" href="https://github.com/bjodah/pyodeint">pyodeint</a> (requires <a class="reference external" href="http://www.boost.org/">boost</a> &gt;=1.65.0)</li>
<li><a class="reference external" href="https://github.com/bjodah/pycvodes">pycvodes</a> (requires <a class="reference external" href="https://computation.llnl.gov/projects/sundials">SUNDIALS</a> &gt;=2.7.0)</li>
</ul>
<p>if you want to see what packages need to be installed on a Debian based system you may look at this
<a class="reference external" href="scripts/environment/Dockerfile">Dockerfile</a>.</p>
<p>If you manage to install all three external libraries you may install pyodesys with the option “all”:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ pip install pyodesys[all]
$ pytest --pyargs pyodesys -rs
</pre></div>
</div>
<p>now there should be no skipped tests. If you try to install pyodesys on a machine where you do not have
root permissions you may find the flag <code class="docutils literal notranslate"><span class="pre">--user</span></code> helpful when using pip. Also if there are multiple
versions of python installed you may want to invoke python for an explicit version of python, e.g.:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ python3.6 -m pip install --user pyodesys[all]
</pre></div>
</div>
<p>see <a class="reference external" href="setup.py">setup.py</a> for the exact list of requirements.</p>
</div>
<div class="section" id="using-docker">
<h3>Using Docker<a class="headerlink" href="#using-docker" title="Permalink to this headline">¶</a></h3>
<p>If you have <a class="reference external" href="https://www.docker.com">Docker</a> installed, you may use it to host a jupyter
notebook server:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ ./scripts/host-jupyter-using-docker.sh . 8888
</pre></div>
</div>
<p>the first time you run the command some dependencies will be downloaded. When the installation
is complete there will be a link visible which you can open in your browser. You can also run
the test suite using the same docker-image:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ ./scripts/host-jupyter-using-docker.sh . 0
</pre></div>
</div>
<p>there will be one skipped test (due to symengine missing in this pip installed environment) and
quite a few instances of RuntimeWarning.</p>
</div>
</div>
<div class="section" id="examples">
<h2>Examples<a class="headerlink" href="#examples" title="Permalink to this headline">¶</a></h2>
<p>The classic van der Pol oscillator (see <a class="reference external" href="examples/van_der_pol.py">examples/van_der_pol.py</a>)</p>
<div class="code python highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pyodesys.symbolic</span> <span class="k">import</span> <span class="n">SymbolicSys</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">f</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">p</span><span class="p">):</span>
<span class="gp">... </span>    <span class="k">return</span> <span class="p">[</span><span class="n">y</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="o">-</span><span class="n">y</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">y</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">y</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="p">)]</span>
<span class="gp">...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">odesys</span> <span class="o">=</span> <span class="n">SymbolicSys</span><span class="o">.</span><span class="n">from_callback</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">xout</span><span class="p">,</span> <span class="n">yout</span><span class="p">,</span> <span class="n">info</span> <span class="o">=</span> <span class="n">odesys</span><span class="o">.</span><span class="n">integrate</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">integrator</span><span class="o">=</span><span class="s1">&#39;odeint&#39;</span><span class="p">,</span> <span class="n">nsteps</span><span class="o">=</span><span class="mi">1000</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">_</span> <span class="o">=</span> <span class="n">odesys</span><span class="o">.</span><span class="n">plot_result</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span><span class="p">;</span> <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>  
</pre></div>
</div>
<img alt="https://raw.githubusercontent.com/bjodah/pyodesys/master/examples/van_der_pol.png" src="https://raw.githubusercontent.com/bjodah/pyodesys/master/examples/van_der_pol.png" />
<p>If the expression contains transcendental functions you will need to provide a <code class="docutils literal notranslate"><span class="pre">backend</span></code> keyword argument:</p>
<div class="code python highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">math</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">f</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">backend</span><span class="o">=</span><span class="n">math</span><span class="p">):</span>
<span class="gp">... </span>    <span class="k">return</span> <span class="p">[</span><span class="n">backend</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">y</span><span class="p">[</span><span class="mi">0</span><span class="p">])]</span>  <span class="c1"># analytic: y(x) := ln(kx + kc)/k</span>
<span class="gp">...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">odesys</span> <span class="o">=</span> <span class="n">SymbolicSys</span><span class="o">.</span><span class="n">from_callback</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">y0</span><span class="p">,</span> <span class="n">k</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">xout</span><span class="p">,</span> <span class="n">yout</span><span class="p">,</span> <span class="n">info</span> <span class="o">=</span> <span class="n">odesys</span><span class="o">.</span><span class="n">integrate</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="p">[</span><span class="n">y0</span><span class="p">],</span> <span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="n">integrator</span><span class="o">=</span><span class="s1">&#39;cvode&#39;</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;bdf&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">_</span> <span class="o">=</span> <span class="n">odesys</span><span class="o">.</span><span class="n">plot_result</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">c</span> <span class="o">=</span> <span class="mf">1.</span><span class="o">/</span><span class="n">k</span><span class="o">*</span><span class="n">math</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">k</span><span class="o">*</span><span class="n">y0</span><span class="p">)</span>  <span class="c1"># integration constant</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">_</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xout</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">k</span><span class="o">*</span><span class="p">(</span><span class="n">xout</span><span class="o">+</span><span class="n">c</span><span class="p">))</span><span class="o">/</span><span class="n">k</span><span class="p">,</span> <span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=.</span><span class="mi">5</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;analytic&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">_</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;best&#39;</span><span class="p">);</span> <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>  
</pre></div>
</div>
<img alt="https://raw.githubusercontent.com/bjodah/pyodesys/master/examples/lnx.png" src="https://raw.githubusercontent.com/bjodah/pyodesys/master/examples/lnx.png" />
<p>If you already have symbolic expressions created using e.g. SymPy you can create your system from those:</p>
<div class="code python highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">sympy</span> <span class="k">as</span> <span class="nn">sp</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="p">,</span> <span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">k</span>  <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;t u v k&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dudt</span> <span class="o">=</span> <span class="n">v</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dvdt</span> <span class="o">=</span> <span class="o">-</span><span class="n">k</span><span class="o">*</span><span class="n">u</span>  <span class="c1"># differential equations for a harmonic oscillator</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">odesys</span> <span class="o">=</span> <span class="n">SymbolicSys</span><span class="p">([(</span><span class="n">u</span><span class="p">,</span> <span class="n">dudt</span><span class="p">),</span> <span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="n">dvdt</span><span class="p">)],</span> <span class="n">t</span><span class="p">,</span> <span class="p">[</span><span class="n">k</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">odesys</span><span class="o">.</span><span class="n">integrate</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="p">{</span><span class="n">u</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="n">v</span><span class="p">:</span> <span class="mi">0</span><span class="p">},</span> <span class="p">{</span><span class="n">k</span><span class="p">:</span> <span class="mi">3</span><span class="p">},</span> <span class="n">integrator</span><span class="o">=</span><span class="s1">&#39;gsl&#39;</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;rk8pd&#39;</span><span class="p">,</span> <span class="n">atol</span><span class="o">=</span><span class="mf">1e-11</span><span class="p">,</span> <span class="n">rtol</span><span class="o">=</span><span class="mf">1e-12</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">_</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">_</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">_</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">_</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">result</span><span class="o">.</span><span class="n">xout</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">result</span><span class="o">.</span><span class="n">xout</span><span class="o">*</span><span class="mi">3</span><span class="o">**</span><span class="mf">0.5</span><span class="p">)</span> <span class="o">-</span> <span class="n">result</span><span class="o">.</span><span class="n">yout</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>  
</pre></div>
</div>
<img alt="https://raw.githubusercontent.com/bjodah/pyodesys/master/examples/harmonic.png" src="https://raw.githubusercontent.com/bjodah/pyodesys/master/examples/harmonic.png" />
<p>You can also refer to the dependent variables by name instead of index:</p>
<div class="code python highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">odesys</span> <span class="o">=</span> <span class="n">SymbolicSys</span><span class="o">.</span><span class="n">from_callback</span><span class="p">(</span>
<span class="gp">... </span>    <span class="k">lambda</span> <span class="n">t</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">p</span><span class="p">:</span> <span class="p">{</span>
<span class="gp">... </span>        <span class="s1">&#39;x&#39;</span><span class="p">:</span> <span class="o">-</span><span class="n">p</span><span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">]</span><span class="o">*</span><span class="n">y</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">],</span>
<span class="gp">... </span>        <span class="s1">&#39;y&#39;</span><span class="p">:</span> <span class="o">-</span><span class="n">p</span><span class="p">[</span><span class="s1">&#39;b&#39;</span><span class="p">]</span><span class="o">*</span><span class="n">y</span><span class="p">[</span><span class="s1">&#39;y&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="n">p</span><span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">]</span><span class="o">*</span><span class="n">y</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">],</span>
<span class="gp">... </span>        <span class="s1">&#39;z&#39;</span><span class="p">:</span> <span class="n">p</span><span class="p">[</span><span class="s1">&#39;b&#39;</span><span class="p">]</span><span class="o">*</span><span class="n">y</span><span class="p">[</span><span class="s1">&#39;y&#39;</span><span class="p">]</span>
<span class="gp">... </span>    <span class="p">},</span> <span class="n">names</span><span class="o">=</span><span class="s1">&#39;xyz&#39;</span><span class="p">,</span> <span class="n">param_names</span><span class="o">=</span><span class="s1">&#39;ab&#39;</span><span class="p">,</span> <span class="n">dep_by_name</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">par_by_name</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="p">,</span> <span class="n">ic</span><span class="p">,</span> <span class="n">pars</span> <span class="o">=</span> <span class="p">[</span><span class="mi">42</span><span class="p">,</span> <span class="mi">43</span><span class="p">,</span> <span class="mi">44</span><span class="p">],</span> <span class="p">{</span><span class="s1">&#39;x&#39;</span><span class="p">:</span> <span class="mi">7</span><span class="p">,</span> <span class="s1">&#39;y&#39;</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span> <span class="s1">&#39;z&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">},</span> <span class="p">{</span><span class="s1">&#39;a&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">11</span><span class="p">,</span> <span class="mi">17</span><span class="p">,</span> <span class="mi">19</span><span class="p">],</span> <span class="s1">&#39;b&#39;</span><span class="p">:</span> <span class="mi">13</span><span class="p">}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">r</span><span class="p">,</span> <span class="n">a</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">odesys</span><span class="o">.</span><span class="n">integrate</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">ic</span><span class="p">,</span> <span class="n">pars</span><span class="p">,</span> <span class="n">integrator</span><span class="o">=</span><span class="s1">&#39;cvode&#39;</span><span class="p">),</span> <span class="n">pars</span><span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">]):</span>
<span class="gp">... </span>    <span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">r</span><span class="o">.</span><span class="n">named_dep</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">),</span> <span class="mi">7</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">a</span><span class="o">*</span><span class="p">(</span><span class="n">r</span><span class="o">.</span><span class="n">xout</span> <span class="o">-</span> <span class="n">r</span><span class="o">.</span><span class="n">xout</span><span class="p">[</span><span class="mi">0</span><span class="p">])))</span>
<span class="gp">... </span>    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%.2f</span><span class="s1"> ms &#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">r</span><span class="o">.</span><span class="n">info</span><span class="p">[</span><span class="s1">&#39;time_cpu&#39;</span><span class="p">]</span><span class="o">*</span><span class="mf">1e3</span><span class="p">))</span>  
<span class="gp">...</span>
<span class="go">10.54 ms</span>
<span class="go">11.55 ms</span>
<span class="go">11.06 ms</span>
</pre></div>
</div>
<p>Note how we generated a list of results for each value of the parameter <code class="docutils literal notranslate"><span class="pre">a</span></code>. When using a class
from <code class="docutils literal notranslate"><span class="pre">pyodesys.native.native_sys</span></code> those integrations are run in separate threads (bag of tasks
parallelism):</p>
<div class="code python highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pyodesys.native</span> <span class="k">import</span> <span class="n">native_sys</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">native</span> <span class="o">=</span> <span class="n">native_sys</span><span class="p">[</span><span class="s1">&#39;cvode&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">from_other</span><span class="p">(</span><span class="n">odesys</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">r</span><span class="p">,</span> <span class="n">a</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">native</span><span class="o">.</span><span class="n">integrate</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">ic</span><span class="p">,</span> <span class="n">pars</span><span class="p">),</span> <span class="n">pars</span><span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">]):</span>
<span class="gp">... </span>    <span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">r</span><span class="o">.</span><span class="n">named_dep</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">),</span> <span class="mi">7</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">a</span><span class="o">*</span><span class="p">(</span><span class="n">r</span><span class="o">.</span><span class="n">xout</span> <span class="o">-</span> <span class="n">r</span><span class="o">.</span><span class="n">xout</span><span class="p">[</span><span class="mi">0</span><span class="p">])))</span>
<span class="gp">... </span>    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%.2f</span><span class="s1"> ms &#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">r</span><span class="o">.</span><span class="n">info</span><span class="p">[</span><span class="s1">&#39;time_cpu&#39;</span><span class="p">]</span><span class="o">*</span><span class="mf">1e3</span><span class="p">))</span>  
<span class="gp">...</span>
<span class="go">0.42 ms</span>
<span class="go">0.43 ms</span>
<span class="go">0.42 ms</span>
</pre></div>
</div>
<p>For this small example we see a 20x (serial) speedup by using native code. Bigger systems often see 100x speedup.
Since the latter is run in parallel the (wall clock) time spent waiting for the results is in practice
further reduced by a factor equal to the number of cores of your CPU (number of threads used is set by
the environment variable <code class="docutils literal notranslate"><span class="pre">ANYODE_NUM_THREADS</span></code>).</p>
<p>For further examples, see <a class="reference external" href="https://github.com/bjodah/pyodesys/tree/master/examples">examples/</a>, and rendered
jupyter notebooks here: <a class="reference external" href="http://hera.physchem.kth.se/~pyodesys/branches/master/examples">http://hera.physchem.kth.se/~pyodesys/branches/master/examples</a></p>
<div class="section" id="run-notebooks-using-binder">
<h3>Run notebooks using binder<a class="headerlink" href="#run-notebooks-using-binder" title="Permalink to this headline">¶</a></h3>
<p>Using only a web-browser (and an internet connection) it is possible to explore the
notebooks here: (by the courtesy of the people behind mybinder)</p>
<a class="reference external image-reference" href="https://mybinder.org/v2/gh/bjodah/pyodesys/v0.11.6?filepath=index.ipynb"><img alt="Binder" src="http://mybinder.org/badge.svg" /></a>
</div>
</div>
<div class="section" id="citing">
<h2>Citing<a class="headerlink" href="#citing" title="Permalink to this headline">¶</a></h2>
<p>If you make use of pyodesys in e.g. academic work you may cite the following peer-reviewed publication:</p>
<a class="reference external image-reference" href="https://doi.org/10.21105/joss.00490"><img alt="Journal of Open Source Software DOI" src="http://joss.theoj.org/papers/10.21105/joss.00490/status.svg" /></a>
<p>Depending on what underlying solver you are using you should also cite the appropriate paper
(you can look at the list of references in the JOSS article). If you need to reference,
in addition to the paper, a specific point version of pyodesys (for e.g. reproducibility)
you can get per-version DOIs from the zenodo archive:</p>
<a class="reference external image-reference" href="https://zenodo.org/badge/latestdoi/43131469"><img alt="Zenodo DOI" src="https://zenodo.org/badge/43131469.svg" /></a>
</div>
<div class="section" id="license">
<h2>License<a class="headerlink" href="#license" title="Permalink to this headline">¶</a></h2>
<p>The source code is Open Source and is released under the simplified 2-clause BSD license. See <a class="reference external" href="LICENSE">LICENSE</a> for further details.</p>
</div>
<div class="section" id="contributing">
<h2>Contributing<a class="headerlink" href="#contributing" title="Permalink to this headline">¶</a></h2>
<p>Contributors are welcome to suggest improvements at <a class="reference external" href="https://github.com/bjodah/pyodesys">https://github.com/bjodah/pyodesys</a> (see further details <a class="reference external" href="CONTRIBUTORS.rst">here</a>).</p>
</div>
<div class="section" id="author">
<h2>Author<a class="headerlink" href="#author" title="Permalink to this headline">¶</a></h2>
<p>Björn I. Dahlgren, contact:</p>
<blockquote>
<div><ul class="simple">
<li>gmail address: bjodah</li>
<li>kth.se address: bda</li>
</ul>
</div></blockquote>
</div>
</div>


           </div>
           <div class="articleComments">
            
           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="pyodesys.html" class="btn btn-neutral float-right" title="pyodesys package" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2018, Bjoern I. Dahlgren &lt;bjodah@gmail.com&gt;.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'./',
            VERSION:'0.12.2',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="_static/jquery.js"></script>
      <script type="text/javascript" src="_static/underscore.js"></script>
      <script type="text/javascript" src="_static/doctools.js"></script>

  

  
  
    <script type="text/javascript" src="_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>